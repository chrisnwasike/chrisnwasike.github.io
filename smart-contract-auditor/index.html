<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Contract Security Auditor - Free AI-Powered Analysis</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #1f2937;
            --border-color: #30363d;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --accent-blue: #58a6ff;
            --accent-green: #2ea043;
            --critical: #ff4444;
            --high: #ff8800;
            --medium: #ffbb33;
            --low: #00C851;
            --info: #33b5e5;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 1.5rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-blue), #2ea043);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 600;
            background: linear-gradient(135deg, var(--accent-blue), #2ea043);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .badge {
            background: rgba(88, 166, 255, 0.1);
            color: var(--accent-blue);
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            border: 1px solid rgba(88, 166, 255, 0.2);
        }

        .main-content {
            padding: 3rem 0;
        }

        .intro {
            text-align: center;
            margin-bottom: 3rem;
        }

        .intro h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .intro p {
            color: var(--text-secondary);
            font-size: 1.125rem;
            max-width: 700px;
            margin: 0 auto;
        }

        .auditor-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .editor-panel, .results-panel {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }

        .panel-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-tertiary);
        }

        .panel-title {
            font-weight: 600;
            font-size: 1rem;
        }

        .code-editor {
            width: 100%;
            height: 600px;
            padding: 1.5rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            border: none;
            resize: none;
            font-family: 'Fira Code', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
            outline: none;
        }

        .code-editor::placeholder {
            color: var(--text-secondary);
        }

        .analyze-btn {
            background: linear-gradient(135deg, var(--accent-blue), #2ea043);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(88, 166, 255, 0.3);
        }

        .analyze-btn:active {
            transform: translateY(0);
        }

        .analyze-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .results-container {
            padding: 1.5rem;
            min-height: 600px;
            max-height: 600px;
            overflow-y: auto;
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-secondary);
            text-align: center;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .summary-card {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid;
        }

        .summary-card.critical { border-left-color: var(--critical); }
        .summary-card.high { border-left-color: var(--high); }
        .summary-card.medium { border-left-color: var(--medium); }
        .summary-card.low { border-left-color: var(--low); }
        .summary-card.info { border-left-color: var(--info); }
        .summary-card.good { border-left-color: var(--accent-green); }

        .summary-card h3 {
            font-size: 2rem;
            margin-bottom: 0.25rem;
        }

        .summary-card p {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .security-strengths {
            background: rgba(46, 160, 67, 0.1);
            border: 1px solid rgba(46, 160, 67, 0.3);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .security-strengths h3 {
            color: var(--accent-green);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .strength-item {
            padding: 0.5rem 0;
            color: var(--text-secondary);
        }

        .strength-item::before {
            content: "‚úì ";
            color: var(--accent-green);
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .finding {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid;
        }

        .finding.critical { border-left-color: var(--critical); }
        .finding.high { border-left-color: var(--high); }
        .finding.medium { border-left-color: var(--medium); }
        .finding.low { border-left-color: var(--low); }
        .finding.info { border-left-color: var(--info); }

        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }

        .finding-title {
            font-weight: 600;
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
        }

        .severity-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .severity-badge.critical {
            background: rgba(255, 68, 68, 0.15);
            color: var(--critical);
        }

        .severity-badge.high {
            background: rgba(255, 136, 0, 0.15);
            color: var(--high);
        }

        .severity-badge.medium {
            background: rgba(255, 187, 51, 0.15);
            color: var(--medium);
        }

        .severity-badge.low {
            background: rgba(0, 200, 81, 0.15);
            color: var(--low);
        }

        .severity-badge.info {
            background: rgba(51, 181, 229, 0.15);
            color: var(--info);
        }

        .finding-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .code-snippet {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 1rem;
            margin: 0.5rem 0;
            font-family: 'Fira Code', monospace;
            font-size: 0.875rem;
            overflow-x: auto;
        }

        .recommendation {
            background: rgba(88, 166, 255, 0.1);
            border-left: 3px solid var(--accent-blue);
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 4px;
        }

        .recommendation strong {
            color: var(--accent-blue);
            display: block;
            margin-bottom: 0.5rem;
        }

        .line-number {
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.875rem;
        }

        .examples-section {
            margin-top: 3rem;
            padding: 2rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
        }

        .examples-section h3 {
            margin-bottom: 1rem;
        }

        .example-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .example-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .example-btn:hover {
            background: var(--bg-primary);
            border-color: var(--accent-blue);
        }

        .loader {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 968px) {
            .auditor-grid {
                grid-template-columns: 1fr;
            }
        }

        .footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
            border-top: 1px solid var(--border-color);
            margin-top: 4rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">üõ°Ô∏è</div>
                    <h1>Smart Contract Auditor</h1>
                </div>
                <div class="badge">FREE & OPEN SOURCE</div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <div class="intro">
                <h2>AI-Powered Smart Contract Security Analysis</h2>
                <p>Paste your Solidity smart contract below to get instant security analysis. Handles production contracts with OpenZeppelin imports.</p>
            </div>

            <div class="auditor-grid">
                <div class="editor-panel">
                    <div class="panel-header">
                        <span class="panel-title">üìù Smart Contract Code</span>
                        <button class="analyze-btn" id="analyzeBtn" onclick="analyzeContract()">
                            Analyze Contract
                        </button>
                    </div>
                    <textarea
                        class="code-editor"
                        id="codeEditor"
                        placeholder="// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract YourContract {
    // Paste your Solidity code here...
    // Supports OpenZeppelin imports and production contracts
}"
                    ></textarea>
                </div>

                <div class="results-panel">
                    <div class="panel-header">
                        <span class="panel-title">üîç Analysis Results</span>
                    </div>
                    <div class="results-container" id="resultsContainer">
                        <div class="empty-state">
                            <div class="empty-state-icon">üîí</div>
                            <h3>No Analysis Yet</h3>
                            <p>Paste your smart contract code and click "Analyze Contract" to begin security analysis.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="examples-section">
                <h3>Try Example Contracts</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                    Click any example below to load a contract
                </p>
                <div class="example-buttons">
                    <button class="example-btn" onclick="loadExample('reentrancy')">Reentrancy Attack</button>
                    <button class="example-btn" onclick="loadExample('accessControl')">Access Control Issue</button>
                    <button class="example-btn" onclick="loadExample('uncheckedCall')">Unchecked External Call</button>
                    <button class="example-btn" onclick="loadExample('txOrigin')">tx.origin Authentication</button>
                    <button class="example-btn" onclick="loadExample('delegatecall')">Unsafe Delegatecall</button>
                    <button class="example-btn" onclick="loadExample('production')">Production Token (JUNK)</button>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <p>Built by Chris Nwasike | Open Source Smart Contract Security Tool</p>
        <p style="margin-top: 0.5rem; font-size: 0.875rem;">
            This tool provides automated analysis and should not replace professional audits for production contracts.
        </p>
    </footer>

    <script>
        // Enhanced security analysis engine
        class SmartContractAnalyzer {
            constructor(code) {
                this.code = code;
                this.lines = code.split('\n');
                this.findings = [];
                this.strengths = [];
            }

            analyze() {
                // First, identify security strengths
                this.identifySecurityStrengths();

                // Then check for vulnerabilities
                this.checkReentrancy();
                this.checkAccessControl();
                this.checkUncheckedCalls();
                this.checkTxOrigin();
                this.checkDelegatecall();
                this.checkIntegerOperations();
                this.checkCentralization();
                this.checkInputValidation();
                this.checkEventEmissions();

                return {
                    findings: this.findings,
                    strengths: this.strengths
                };
            }

            identifySecurityStrengths() {
                // Check for OpenZeppelin usage
                if (this.code.match(/@openzeppelin\/contracts/)) {
                    this.strengths.push('Uses OpenZeppelin contracts - industry-standard, audited implementations');
                }

                // Check for AccessControl
                if (this.code.match(/AccessControl|Ownable/)) {
                    this.strengths.push('Implements role-based access control for privilege management');
                }

                // Check for Pausable
                if (this.code.match(/Pausable/)) {
                    this.strengths.push('Includes emergency pause functionality for incident response');
                }

                // Check for ReentrancyGuard
                if (this.code.match(/ReentrancyGuard|nonReentrant/)) {
                    this.strengths.push('Uses ReentrancyGuard to prevent reentrancy attacks');
                }

                // Check for SafeMath or Solidity 0.8+
                const version = this.code.match(/pragma\s+solidity\s+[\^<>=]*(\d+\.\d+)/);
                if (version && parseFloat(version[1]) >= 0.8) {
                    this.strengths.push('Uses Solidity 0.8+ with built-in overflow/underflow protection');
                } else if (this.code.match(/SafeMath/)) {
                    this.strengths.push('Uses SafeMath library for arithmetic operations');
                }

                // Check for custom errors
                if (this.code.match(/error\s+\w+/)) {
                    this.strengths.push('Uses custom errors for gas-efficient error handling');
                }

                // Check for natspec documentation
                if (this.code.match(/@notice|@dev|@param|@return/)) {
                    this.strengths.push('Includes NatSpec documentation for better code transparency');
                }

                // Check for events
                if (this.code.match(/event\s+\w+/)) {
                    this.strengths.push('Emits events for off-chain tracking and transparency');
                }
            }

            checkReentrancy() {
                // Skip if using ReentrancyGuard
                if (this.code.match(/ReentrancyGuard|nonReentrant/)) {
                    return;
                }

                this.lines.forEach((line, idx) => {
                    const trimmed = line.trim();

                    if (trimmed.match(/\.call\{value:|\.transfer\(|\.send\(/)) {
                        // Look ahead for state changes
                        const codeAfter = this.lines.slice(idx + 1, idx + 10).join('\n');
                        const codeBefore = this.lines.slice(Math.max(0, idx - 20), idx).join('\n');

                        // Check if this is in a function with reentrancy protection
                        const hasNonReentrant = codeBefore.match(/nonReentrant/);
                        const hasChecksEffectsPattern = !codeAfter.match(/\w+\s*[\+\-\*\/]=|\w+\s*=\s*[^=]/);

                        if (!hasNonReentrant && !hasChecksEffectsPattern && codeAfter.match(/\w+\s*=|balances\[|\.push\(|\.pop\(/)) {
                            this.findings.push({
                                severity: 'critical',
                                title: 'Potential Reentrancy Vulnerability',
                                line: idx + 1,
                                code: trimmed,
                                description: 'External call detected with state changes afterward. This violates the Checks-Effects-Interactions pattern and may be vulnerable to reentrancy.',
                                recommendation: 'Move all state changes before external calls, or use OpenZeppelin\'s ReentrancyGuard.'
                            });
                        }
                    }
                });
            }

            checkAccessControl() {
                // Skip if using proper access control
                const hasAccessControl = this.code.match(/AccessControl|Ownable|onlyRole|onlyOwner/);

                this.lines.forEach((line, idx) => {
                    const trimmed = line.trim();

                    // Look for sensitive operations
                    if (trimmed.match(/function\s+(\w+)/)) {
                        const functionMatch = trimmed.match(/function\s+(\w+)\s*\([^)]*\)\s*(public|external)/);

                        if (functionMatch) {
                            const functionName = functionMatch[1];
                            const functionBlock = this.lines.slice(idx, idx + 30).join('\n');

                            // Check for sensitive operations
                            const hasSensitiveOp = functionBlock.match(/selfdestruct|delegatecall|_mint\(|_burn\(/);
                            const hasModifier = line.match(/onlyOwner|onlyRole|onlyAdmin/) ||
                                              functionBlock.match(/require\s*\(\s*msg\.sender\s*==|require\s*\(\s*hasRole/);

                            if (hasSensitiveOp && !hasModifier && !hasAccessControl) {
                                this.findings.push({
                                    severity: 'critical',
                                    title: 'Missing Access Control',
                                    line: idx + 1,
                                    code: trimmed,
                                    description: `Function '${functionName}' performs sensitive operations without access control.`,
                                    recommendation: 'Add access control modifiers like onlyOwner or onlyRole, or use OpenZeppelin AccessControl.'
                                });
                            }
                        }
                    }

                    // Check for unprotected selfdestruct
                    if (trimmed.match(/selfdestruct\s*\(/)) {
                        const functionStart = this.lines.slice(Math.max(0, idx - 15), idx).join('\n');
                        const hasProtection = functionStart.match(/onlyOwner|onlyRole|onlyAdmin|require\s*\(\s*msg\.sender/);

                        if (!hasProtection) {
                            this.findings.push({
                                severity: 'critical',
                                title: 'Unprotected Selfdestruct',
                                line: idx + 1,
                                code: trimmed,
                                description: 'Selfdestruct can be called by anyone, allowing contract destruction and fund theft.',
                                recommendation: 'Add onlyOwner or similar access control to selfdestruct functions.'
                            });
                        }
                    }
                });
            }

            checkUncheckedCalls() {
                this.lines.forEach((line, idx) => {
                    const trimmed = line.trim();

                    if (trimmed.match(/\.call\{|\.send\(/)) {
                        const hasCheck = trimmed.match(/\(bool\s+\w+|bool\s+\w+\s*=|require\s*\(/);
                        const nextLine = this.lines[idx + 1] || '';
                        const hasNextLineCheck = nextLine.match(/require\s*\(/);

                        if (!hasCheck && !hasNextLineCheck) {
                            this.findings.push({
                                severity: 'high',
                                title: 'Unchecked External Call',
                                line: idx + 1,
                                code: trimmed,
                                description: 'External call return value not checked. Failed calls will silently fail.',
                                recommendation: 'Always check return values: (bool success, ) = addr.call{value: x}(""); require(success);'
                            });
                        }
                    }
                });
            }

            checkTxOrigin() {
                this.lines.forEach((line, idx) => {
                    if (line.match(/tx\.origin/) && line.match(/require|if.*==|modifier/)) {
                        this.findings.push({
                            severity: 'high',
                            title: 'tx.origin Used for Authorization',
                            line: idx + 1,
                            code: line.trim(),
                            description: 'tx.origin is vulnerable to phishing attacks. Use msg.sender instead.',
                            recommendation: 'Replace tx.origin with msg.sender for all authorization checks.'
                        });
                    }
                });
            }

            checkDelegatecall() {
                this.lines.forEach((line, idx) => {
                    if (line.match(/\.delegatecall\(/)) {
                        const isUserControlled = !line.match(/constant|immutable/) || line.match(/_\w+|calldata/);

                        if (isUserControlled) {
                            this.findings.push({
                                severity: 'critical',
                                title: 'Unsafe Delegatecall',
                                line: idx + 1,
                                code: line.trim(),
                                description: 'Delegatecall to potentially untrusted address. This can lead to complete contract takeover.',
                                recommendation: 'Only delegatecall to trusted, immutable addresses. Never allow user-controlled targets.'
                            });
                        }
                    }
                });
            }

            checkIntegerOperations() {
                const version = this.code.match(/pragma\s+solidity\s+[\^<>=]*(\d+\.\d+)/);

                if (version && parseFloat(version[1]) < 0.8) {
                    const hasSafeMath = this.code.match(/SafeMath/);

                    if (!hasSafeMath) {
                        this.findings.push({
                            severity: 'high',
                            title: 'Integer Overflow/Underflow Risk',
                            line: 1,
                            code: version[0],
                            description: 'Using Solidity < 0.8.0 without SafeMath. Arithmetic operations can overflow/underflow.',
                            recommendation: 'Upgrade to Solidity 0.8.0+ or use OpenZeppelin SafeMath library.'
                        });
                    }
                }
            }

            checkCentralization() {
                // Check for admin privileges
                const hasAdminRole = this.code.match(/DEFAULT_ADMIN_ROLE|onlyOwner|onlyAdmin/);
                const hasPause = this.code.match(/pause\(\)|_pause\(\)/);
                const hasMint = this.code.match(/function\s+mint|_mint\(/);
                const hasBurn = this.code.match(/function\s+adminBurn|BURNER_ROLE/);

                if (hasAdminRole && (hasPause || hasMint || hasBurn)) {
                    let risks = [];
                    if (hasPause) risks.push('pause/unpause');
                    if (hasMint) risks.push('mint tokens');
                    if (hasBurn) risks.push('burn tokens');

                    this.findings.push({
                        severity: 'medium',
                        title: 'Centralization Risk',
                        line: 0,
                        code: '',
                        description: `Admin/owner has significant control: ${risks.join(', ')}. Users must trust the admin.`,
                        recommendation: 'Consider: (1) Multi-sig for admin role, (2) Timelock for sensitive operations, (3) Gradual decentralization plan, (4) Transparent governance.'
                            });
                }
            }

            checkInputValidation() {
                this.lines.forEach((line, idx) => {
                    const trimmed = line.trim();

                    // Check for zero address validation
                    if (trimmed.match(/function\s+\w+.*address\s+\w+/)) {
                        const functionBlock = this.lines.slice(idx, idx + 20).join('\n');
                        const params = trimmed.match(/address\s+(\w+)/g);

                        if (params) {
                            params.forEach(param => {
                                const paramName = param.replace('address ', '');
                                const hasCheck = functionBlock.match(new RegExp(`${paramName}\\s*[!=]=\\s*address\\s*\\(\\s*0\\s*\\)|InvalidAddress|ZeroAddress`));

                                if (!hasCheck && !functionBlock.match(/internal|private/)) {
                                    // This would create too many false positives, so we'll skip it
                                    // unless it's a critical function
                                    if (trimmed.match(/onlyOwner|onlyAdmin|constructor/)) {
                                        this.findings.push({
                                            severity: 'low',
                                            title: 'Missing Zero Address Check',
                                            line: idx + 1,
                                            code: trimmed,
                                            description: `Parameter '${paramName}' should be validated against zero address.`,
                                            recommendation: 'Add: if (address == address(0)) revert InvalidAddress();'
                                        });
                                    }
                                }
                            });
                        }
                    }
                });
            }

            checkEventEmissions() {
                // Check if state-changing functions emit events
                let stateChangeFunctions = 0;
                let eventsEmitted = 0;

                this.lines.forEach((line, idx) => {
                    const trimmed = line.trim();

                    if (trimmed.match(/function\s+\w+.*\)\s*(public|external)/) &&
                        !trimmed.match(/view|pure/)) {
                        stateChangeFunctions++;

                        const functionBlock = this.lines.slice(idx, idx + 30).join('\n');
                        if (functionBlock.match(/emit\s+\w+/)) {
                            eventsEmitted++;
                        }
                    }
                });

                // Only flag if there are many functions without events
                if (stateChangeFunctions > 5 && eventsEmitted < stateChangeFunctions * 0.5) {
                    this.findings.push({
                        severity: 'info',
                        title: 'Limited Event Emissions',
                        line: 0,
                        code: '',
                        description: 'Some state-changing functions don\'t emit events. Events improve transparency and off-chain tracking.',
                        recommendation: 'Emit events for all significant state changes to improve transparency.'
                    });
                }
            }
        }

        function analyzeContract() {
            const code = document.getElementById('codeEditor').value;
            const resultsContainer = document.getElementById('resultsContainer');
            const analyzeBtn = document.getElementById('analyzeBtn');

            if (!code.trim()) {
                alert('Please paste some Solidity code to analyze');
                return;
            }

            // Show loading state
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<span class="loader"></span> Analyzing...';

            // Simulate analysis delay
            setTimeout(() => {
                const analyzer = new SmartContractAnalyzer(code);
                const result = analyzer.analyze();

                displayResults(result.findings, result.strengths);

                // Reset button
                analyzeBtn.disabled = false;
                analyzeBtn.textContent = 'Analyze Contract';
            }, 1000);
        }

        function displayResults(findings, strengths) {
            const resultsContainer = document.getElementById('resultsContainer');

            // Count by severity
            const counts = {
                critical: findings.filter(f => f.severity === 'critical').length,
                high: findings.filter(f => f.severity === 'high').length,
                medium: findings.filter(f => f.severity === 'medium').length,
                low: findings.filter(f => f.severity === 'low').length,
                info: findings.filter(f => f.severity === 'info').length,
                good: strengths.length
            };

            // Sort findings by severity
            const severityOrder = { critical: 0, high: 1, medium: 2, low: 3, info: 4 };
            findings.sort((a, b) => severityOrder[a.severity] - severityOrder[b.severity]);

            let html = `
                <div class="summary-cards">
                    ${counts.good > 0 ? `
                    <div class="summary-card good">
                        <h3>${counts.good}</h3>
                        <p>Security Strengths</p>
                    </div>` : ''}
                    <div class="summary-card critical">
                        <h3>${counts.critical}</h3>
                        <p>Critical Issues</p>
                    </div>
                    <div class="summary-card high">
                        <h3>${counts.high}</h3>
                        <p>High Issues</p>
                    </div>
                    <div class="summary-card medium">
                        <h3>${counts.medium}</h3>
                        <p>Medium Issues</p>
                    </div>
                    <div class="summary-card info">
                        <h3>${counts.info}</h3>
                        <p>Informational</p>
                    </div>
                </div>
            `;

            // Show security strengths
            if (strengths.length > 0) {
                html += `
                    <div class="security-strengths">
                        <h3>‚úì Security Strengths Detected</h3>
                        ${strengths.map(s => `<div class="strength-item">${s}</div>`).join('')}
                    </div>
                `;
            }

            // Show findings
            if (findings.length === 0) {
                html += `
                    <div style="background: rgba(46, 160, 67, 0.1); border: 1px solid rgba(46, 160, 67, 0.3); border-radius: 8px; padding: 2rem; text-align: center;">
                        <h3 style="color: var(--accent-green); margin-bottom: 0.5rem;">‚úì No Critical or High Severity Issues Found</h3>
                        <p style="color: var(--text-secondary);">This automated analysis did not detect critical vulnerabilities. However, always get a professional audit for production contracts.</p>
                    </div>
                `;
            } else {
                findings.forEach(finding => {
                    html += `
                        <div class="finding ${finding.severity}">
                            <div class="finding-header">
                                <div>
                                    <div class="finding-title">${finding.title}</div>
                                    ${finding.line ? `<span class="line-number">Line ${finding.line}</span>` : ''}
                                </div>
                                <span class="severity-badge ${finding.severity}">${finding.severity}</span>
                            </div>
                            <div class="finding-description">${finding.description}</div>
                            ${finding.code ? `<div class="code-snippet"><code>${escapeHtml(finding.code)}</code></div>` : ''}
                            <div class="recommendation">
                                <strong>üí° Recommendation:</strong>
                                ${finding.recommendation}
                            </div>
                        </div>
                    `;
                });
            }

            resultsContainer.innerHTML = html;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Example contracts
        const examples = {
            reentrancy: `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract VulnerableBank {
    mapping(address => uint256) public balances;

    function deposit() public payable {
        balances[msg.sender] += msg.value;
    }

    // VULNERABLE: Reentrancy attack possible
    function withdraw(uint256 amount) public {
        require(balances[msg.sender] >= amount);

        (bool success, ) = msg.sender.call{value: amount}("");
        require(success);

        balances[msg.sender] -= amount; // State change AFTER external call
    }
}`,

            accessControl: `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract VulnerableWallet {
    address public owner;

    constructor() {
        owner = msg.sender;
    }

    // VULNERABLE: No access control
    function withdraw(uint256 amount) public {
        payable(msg.sender).transfer(amount);
    }

    // VULNERABLE: Anyone can destroy
    function destroy() public {
        selfdestruct(payable(msg.sender));
    }

    receive() external payable {}
}`,

            uncheckedCall: `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract UncheckedCalls {
    function sendPayment(address to, uint256 amount) public {
        // VULNERABLE: Return value not checked
        to.call{value: amount}("");
    }
}`,

            txOrigin: `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract TxOriginAuth {
    address public owner;

    constructor() {
        owner = msg.sender;
    }

    // VULNERABLE: Using tx.origin
    function transfer(address to, uint256 amount) public {
        require(tx.origin == owner);
        payable(to).transfer(amount);
    }
}`,

            delegatecall: `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract UnsafeDelegateCall {
    // VULNERABLE: Delegatecall to user input
    function execute(address target, bytes calldata data) public {
        target.delegatecall(data);
    }
}`,

            production: `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.27;

import {ERC20} from "@openzeppelin/contracts/token/ERC20/ERC20.sol";
import {ERC20Burnable} from "@openzeppelin/contracts/token/ERC20/extensions/ERC20Burnable.sol";
import {ERC20Pausable} from "@openzeppelin/contracts/token/ERC20/extensions/ERC20Pausable.sol";
import {AccessControl} from "@openzeppelin/contracts/access/AccessControl.sol";

/**
 * @title JUNK Token
 * @notice Production-ready ERC20 token with role-based access control
 */
contract JUNKToken is ERC20, ERC20Burnable, ERC20Pausable, AccessControl {
    bytes32 public constant MINTER_ROLE = keccak256("MINTER_ROLE");
    bytes32 public constant PAUSER_ROLE = keccak256("PAUSER_ROLE");
    bytes32 public constant BURNER_ROLE = keccak256("BURNER_ROLE");

    uint256 public constant MAX_SUPPLY = 1_000_000_000 * 10**18;

    error ExceedsMaxSupply();
    error InvalidAddress();

    event TokensMintedBy(address indexed minter, address indexed to, uint256 amount);

    constructor(uint256 initialAllocation) ERC20("JUNK", "JUNK") {
        if (initialAllocation > MAX_SUPPLY) revert ExceedsMaxSupply();

        _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);
        _grantRole(PAUSER_ROLE, msg.sender);
        _grantRole(MINTER_ROLE, msg.sender);

        if (initialAllocation > 0) {
            _mint(msg.sender, initialAllocation);
        }
    }

    function mint(address to, uint256 amount) public onlyRole(MINTER_ROLE) {
        if (to == address(0)) revert InvalidAddress();
        if (totalSupply() + amount > MAX_SUPPLY) revert ExceedsMaxSupply();

        _mint(to, amount);
        emit TokensMintedBy(msg.sender, to, amount);
    }

    function pause() public onlyRole(PAUSER_ROLE) {
        _pause();
    }

    function unpause() public onlyRole(PAUSER_ROLE) {
        _unpause();
    }

    function _update(address from, address to, uint256 value)
        internal
        override(ERC20, ERC20Pausable)
    {
        super._update(from, to, value);
    }
}`
        };

        function loadExample(exampleName) {
            const code = examples[exampleName];
            if (code) {
                document.getElementById('codeEditor').value = code;
                setTimeout(() => analyzeContract(), 500);
            }
        }

        // Ctrl+Enter to analyze
        document.getElementById('codeEditor').addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'Enter') {
                analyzeContract();
            }
        });
    </script>
</body>
</html>
